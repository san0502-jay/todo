:root {
  color-scheme: light;
  --bg: #f4f7f5;
  --surface: #fbfdfb;
  --primary: #7fb77e;
  --accent: #f2c6a0;
  --text-main: #2f3e34;
  --text-soft: #9aa5a0;
  --border: #e3ebe5;
  --done: #8db89a;
  --progress: linear-gradient(90deg, #7fb77e, #85aecd);
  --shadow: 0 14px 35px rgba(47, 62, 52, 0.08);
}

body[data-theme='dark'] {
  color-scheme: dark;
  --bg: #1f2722;
  --surface: #2a342e;
  --primary: #8ac889;
  --accent: #d8b194;
  --text-main: #e4efe7;
  --text-soft: #afbbb4;
  --border: #3b4841;
  --done: #93c4a2;
  --progress: linear-gradient(90deg, #8ac889, #80a9d0);
  --shadow: 0 14px 35px rgba(0, 0, 0, 0.35);
}

* { box-sizing: border-box; }


html {
  -webkit-text-size-adjust: 100%;
  text-size-adjust: 100%;
}

body {
  -webkit-tap-highlight-color: transparent;
  padding-top: env(safe-area-inset-top);
  padding-bottom: env(safe-area-inset-bottom);
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: 'Quicksand', system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  color: var(--text-main);
  background: var(--bg);
  transition: background-color 260ms ease, color 260ms ease;
}

.app-shell { min-height: 100vh; display: grid; place-items: center; padding: 2rem 1rem; }
.card { width: min(100%, 760px); border-radius: 20px; background: var(--surface); border: 1px solid var(--border); box-shadow: var(--shadow); padding: 1.5rem; }
.hero-row { display: flex; align-items: center; justify-content: space-between; gap: 0.75rem; }
.tag { margin: 0; color: var(--primary); font-weight: 700; font-size: 0.78rem; text-transform: uppercase; letter-spacing: 0.04em; }
h1 { margin: 0; }
.subtitle { margin: 0.4rem 0 1rem; color: var(--text-soft); }

button, input, select { font: inherit; }

.icon-button {
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 14px;
  border: 1px solid var(--border);
  background: color-mix(in srgb, var(--surface) 90%, var(--accent) 10%);
  cursor: pointer;
}
.theme-icons { display: inline-grid; width: 1.1rem; height: 1.1rem; place-items: center; }

.todo-form { display: grid; grid-template-columns: 1.8fr 1fr 1fr auto; gap: 0.6rem; }
.field-group { display: grid; gap: 0.22rem; }
.field-label { font-size: 0.72rem; color: var(--text-soft); font-weight: 700; padding-left: 0.2rem; }

.todo-form input,
.todo-form select {
  border-radius: 14px;
  border: 1px solid var(--border);
  padding: 0.75rem 0.9rem;
  background: color-mix(in srgb, var(--surface) 92%, var(--accent) 8%);
  color: var(--text-main);
  min-width: 0;
}

/* Mobile date text visibility fix */
input[type='date'] {
  color: var(--text-main);
  -webkit-text-fill-color: var(--text-main);
}
input[type='date']::-webkit-datetime-edit,
input[type='date']::-webkit-date-and-time-value {
  color: var(--text-main);
}

.todo-form input:focus,
.todo-form select:focus,
button:focus-visible {
  outline: none;
  box-shadow: 0 0 0 4px color-mix(in srgb, var(--primary) 30%, transparent);
  border-color: var(--primary);
}

#submit-button { border: none; border-radius: 14px; padding: 0.75rem 1rem; background: color-mix(in srgb, var(--primary) 78%, white 22%); color: #17371b; font-weight: 700; cursor: pointer; transition: transform 220ms ease; align-self: end; }
#submit-button:hover { transform: translateY(-1px); }

.progress { margin-top: 1rem; }
.progress-meta { display: flex; justify-content: space-between; color: var(--text-soft); margin-bottom: 0.4rem; }
.progress-track { width: 100%; height: 10px; border-radius: 999px; overflow: hidden; background: color-mix(in srgb, var(--surface) 60%, var(--text-soft) 15%); }
.progress-fill { display: block; width: 0%; height: 100%; background: var(--progress); transition: width 260ms ease; }

.toolbar { margin-top: 1rem; display: inline-flex; gap: 0.3rem; background: color-mix(in srgb, var(--surface) 75%, var(--accent) 25%); border-radius: 14px; padding: 0.25rem; }
.filter { border: none; background: transparent; color: var(--text-soft); border-radius: 12px; padding: 0.45rem 0.8rem; cursor: pointer; transition: all 220ms ease; }
.filter.is-active { background: var(--surface); color: var(--text-main); }

.empty-state { margin: 1rem 0 0.4rem; color: var(--text-soft); background: color-mix(in srgb, var(--surface) 85%, var(--accent) 15%); border: 1px dashed var(--border); border-radius: 12px; padding: 0.8rem; }

.todo-list { list-style: none; padding: 0; margin: 0.8rem 0 0; display: grid; gap: 0.6rem; }
.todo-item { background: color-mix(in srgb, var(--surface) 90%, var(--accent) 10%); border: 1px solid var(--border); border-radius: 14px; padding: 0.65rem 0.75rem; display: flex; align-items: center; justify-content: space-between; gap: 0.8rem; animation: fade-in 240ms ease; }
.todo-main { display: flex; gap: 0.7rem; width: 100%; align-items: center; cursor: pointer; min-width: 0; }
.todo-item input[type='checkbox'] { position: absolute; opacity: 0; }
.check { width: 1.1rem; height: 1.1rem; border-radius: 0.35rem; border: 2px solid color-mix(in srgb, var(--text-soft) 60%, transparent); background: var(--surface); transition: all 220ms ease; flex-shrink: 0; }
.todo-item input:checked + .check { border-color: var(--primary); background: radial-gradient(circle at 30% 30%, #fff 10%, var(--primary) 11%); }
.text { display: block; overflow-wrap: anywhere; }
.details { display: flex; gap: 0.5rem; margin-top: 0.2rem; flex-wrap: wrap; }

.due,
.priority-badge { font-size: 0.75rem; color: var(--text-soft); background: color-mix(in srgb, var(--surface) 80%, var(--accent) 20%); border-radius: 999px; padding: 0.15rem 0.5rem; }
.priority-badge { color: #203128; font-weight: 700; text-transform: capitalize; }
.priority-badge[data-priority='high'] { background: #f2a172; color: #3a1e10; }
.priority-badge[data-priority='medium'] { background: #8ccf8b; color: #17371b; }
.priority-badge[data-priority='low'] { background: #9fc6e8; color: #14324a; }

.actions { display: flex; gap: 0.4rem; flex-shrink: 0; }
.edit, .delete, .ghost { border: none; border-radius: 12px; padding: 0.45rem 0.55rem; cursor: pointer; color: var(--text-main); background: color-mix(in srgb, var(--surface) 75%, var(--accent) 25%); }

.todo-item.completed .text { color: var(--done); opacity: 0.75; text-decoration: line-through; }

.meta { margin-top: 1rem; display: flex; justify-content: space-between; align-items: center; gap: 0.6rem; color: var(--text-soft); flex-wrap: wrap; }

.sr-only { position: absolute; width: 1px; height: 1px; margin: -1px; overflow: hidden; clip: rect(0, 0, 0, 0); }

@keyframes fade-in { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }

@media (max-width: 980px) {
  .todo-form { grid-template-columns: 1fr 1fr; }
  .todo-form > :first-child { grid-column: span 2; }
  #submit-button { grid-column: span 2; }
}

@media (max-width: 680px) {
  .card { padding: 1rem; border-radius: 16px; }
  .todo-form { grid-template-columns: 1fr; }
  .todo-form > :first-child,
  #submit-button { grid-column: auto; }
  .toolbar { width: 100%; display: grid; grid-template-columns: repeat(3, 1fr); }
  .filter { text-align: center; }
  .todo-item { align-items: flex-start; }
}

@media (max-width: 480px) {
  .app-shell { padding: 1rem 0.65rem; }
  .hero-row { align-items: flex-start; }
  .actions { flex-direction: column; }
}
